---
title: "Finding Features - Scale, Rotation, View Point"
categories:
  - INU-ComputerVision
tags:
  - INU-ComputerVision
toc: true
toc_sticky: true
toc_label: "Carefree to See"
header:
   teaser: "/assets/images/INU/ComputerVision/findingFeatures2_1.png"
---
<!-- Created by Chae Seung Min - CarefreeLife
Visit my Programming blog: https://carefreelife98.github.io --> 
---

# Invariant Descriptors
## Scale
![path](/assets/images/INU/ComputerVision/findingFeatures2_1.png)
> ìœ„ì™€ ê°™ì´ ë‘ ì´ë¯¸ì§€ë¥¼ ë‹¤ë¥¸ Scale ì„ ê°€ì§€ë„ë¡ Crop (Image patches) í•˜ì˜€ì„ ë•Œ, Matching ì„ ìœ„í•´ ë‘ ì´ë¯¸ì§€ê°€ ê°™ì€ íŠ¹ì§•ì„ ê°–ë„ë¡ í•˜ëŠ” ë°©ë²•ì€?<br>
> - ê°€ì¥ ì‰¬ìš´ ë°©ë²•ì€ Crop ëœ ì´ë¯¸ì§€ë¥¼ ì„œë¡œ ë™ì¼í•œ íŠ¹ì§•ì„ ê°–ë„ë¡ ì•„ë˜ì™€ ê°™ì´ Re-scale í•˜ëŠ” ê²ƒ.<br>
> 	![path](/assets/images/INU/ComputerVision/findingFeatures2_2.png)

<br><br>

### Scale Changes íŠ¹ì§•
> **Scale ChangeëŠ” ë§ì€ ì‹œê°„ì´ ì†Œìš”**ë¨.<br>
> - ëª¨ë“  ê²½ìš°ì˜ ìˆ˜ë¥¼ ì „ë¶€ íƒìƒ‰ (Exhaustive Search), ë‘ ê°œì˜ Crop ì˜ì—­ì´ Matchingì´ ë˜ëŠ”ì§€ í™•ì¸í•´ì•¼í•¨.
> <br><br>
> 
> **ì‹œê°„ ë³µì¡ë„**<br>
> - **`O(N^2S)`**<br>
>     - N fearures perimage<br>
>     - S re-scalings per feature

<br><br>

### í•´ê²° ë°©ë²• : ìŠ¤ì¼€ì¼ë§ ìë™í™” (Automatic Scale Selection)
> **Main Idea**<br>
> - **íŠ¹ì • í•¨ìˆ˜ ì‘ì„±**<br>
>   - ê°ê°ì˜ Image Patch (Region) ì˜ ì…ë ¥ì„ ë°›ëŠ” í•¨ìˆ˜ ì‘ì„±.<br>	
>     - Scale Invariant í•œ í•¨ìˆ˜.<br>
>     - **ì„œë¡œ ëŒ€ì‘ë˜ëŠ” Patch ì˜ Scaleì´ ë‹¤ë¥´ë”ë¼ë„ ì…ë ¥ì´ ë˜ì—ˆì„ ë•Œ ê°™ì€ ê°’ì„ ë°˜í™˜ í•´ì£¼ì–´ì•¼ í•¨.**<br>
>        - EX) **Average Intensity**<br>
>        	![path](/assets/images/INU/ComputerVision/findingFeatures2_3.png)<br>
>          - ë‘ Region ì´ **ì„œë¡œ ë‹¤ë¥¸ Scaleì„ ê°€ì§€ë”ë¼ë„ ìœ ì‚¬í•œ í‰ê·  ê°’**ì„ ê°€ì§.

<br><br>

### Automatic Scale Selection ì„ í•˜ê¸° ì¢‹ì€ í•¨ìˆ˜
> ì¢Œí‘œê³„ì—ì„œ **í•˜ë‚˜ì˜ ì•ˆì •ì ì´ê³  ë†’ì€ Peak ê°€ ì¡´ì¬** í•˜ëŠ” ê²½ìš°.<br>
> ![path](/assets/images/INU/ComputerVision/findingFeatures2_4.png)<br>
> - ì—¬ëŸ¬ ê°œì˜ Peak ê°€ ì¡´ì¬í•˜ëŠ” ê²½ìš° ?<br>
>    - **Peakê°€ ë§ìœ¼ë©´ ì í•©í•œ Scale sizeë¥¼ ì°¾ê¸° ì–´ë ¤ìš¸ ìˆ˜ ìˆìŒ.**

<br><br>

### Peakë¥¼ ì°¾ëŠ” ë°©ë²•
> **ê¸°ë³¸ì ì¸ ë°©ë²•ì€ Edge ë¥¼ ì°¾ëŠ” Kernel ì„ Convolve** ì‹œí‚¤ëŠ” ê²ƒ.<br><br>
>
> - ì¢Œí‘œê³„ì—ì„œ Peak (ê·¹ ê°’) ë¥¼ ì°¾ëŠ” ê²ƒì€ **ê¸‰ê²©í•˜ê²Œ ë³€í™”í•˜ëŠ” ë¶€ë¶„**ì„ ì°¾ëŠ”ê²ƒ.<br>
> - ì´ëŠ” ë§ˆì¹˜ ì´ì „ì— ë°°ì› ë˜ **Edge Detection** ê³¼ ì—°ê´€ë¨.<br>

![path](/assets/images/INU/ComputerVision/findingFeatures2_5.png)
- **Laplacian of Gaussian (LoG)** Kernel ì‚¬ìš©.
	- Gaussian ì„ ë‘ ë²ˆ ë¯¸ë¶„í•œ ê²ƒ.

<br><br>

### Example : Automatic Scale Selection
1. **Image ì˜ Scaleì„ í‚¤ì›Œë‚˜ê°€ë©° ê·¸ë˜í”„ ìƒì„±**
   ![path](/assets/images/INU/ComputerVision/findingFeatures2_6.png)
	- ì í•©í•œ Scaleì´ ì°¾ì•„ì§€ë©´ **x, y ì¢Œí‘œê³„ë¡œ ê°€ì ¸ì™€ì„œ ì ì ˆí•œ í¬ê¸°ë¡œ Noramalize** í•œë‹¤.
2. ì´í›„ í•´ë‹¹ **Patch ë“¤ì„ SSD ë¡œ Matching** ì‹œì¼œì¤€ë‹¤.
3. ë§ˆì§€ë§‰ìœ¼ë¡œ **Warping** ì„ í†µí•´ Patch Normalizationì„ ì™„ë£Œí•œë‹¤.
   ![path](/assets/images/INU/ComputerVision/findingFeatures2_7.png)
   <br><br>

## Rotation
> **ì–´ë–»ê²Œ Rotationì˜ ê°•ì¸í•œ (Invariant) Descriptor ë¥¼ ë§Œë“¤ ìˆ˜ ìˆëŠ”ê°€?**<br>
> - Edge ì—ì„œ í™•ì¸í–ˆë˜ **Harris Detector (M Matrix of Harris) ì‚¬ìš©.**<br>
>   1. **M Matrix of Harris ì—ì„œ ì£¼ìš”í•œ ë°©í–¥** (Dominant gradient direction) ì„ ì°¾ëŠ”ë‹¤.<br>
>   2. Warping ì„ í†µí•´ ì¢Œí‘œê³„ë¡œ ì˜®ê²¨ ì˜¬ ìˆ˜ ìˆë‹¤.<br><br>
>
>**HoG (Histogram of Gradient) descriptor**<br>
> 1. ê°ê°ì˜ Imageì— ëŒ€í•˜ì—¬ **Gradient ê³„ì‚°.**<br>
> 2. í•´ë‹¹ Gradient ì— ëŒ€í•œ **Histogram ì‘ì„±.**<br>
> 3. ê° ì´ë¯¸ì§€ì˜ **Gradient ë°©í–¥ì„ ê·¸ë˜í”„ë¡œ** ë³´ì—¬ì¤Œ.<br>
> 	- = ì£¼ìš”í•œ ë°©í–¥ (Dominant Gradient) ì„ ì°¾ì„ ìˆ˜ ìˆìŒ.<br>
> 4. ì°¾ì€ **Hog Descriptor ë¥¼ ë‚˜ì—´í•˜ì—¬ Concatination. (ê²°í•©)**

<br><br>

### Patch ì˜ Orientationì„ ê³„ì‚°í•˜ëŠ” ë°©ë²•.
![path](/assets/images/INU/ComputerVision/findingFeatures2_8.png)
1. **Gaussian Kernelì„ ì´ìš©í•˜ì—¬ ì „ì²´ì  ì´ë¯¸ì§€ë¥¼ Blurr** í•˜ê²Œ ë§Œë“¤ì–´ ì¤€ë‹¤. (ì „ì²˜ë¦¬ ê³¼ì •)
2. **Edge - Gradient Vector ë¥¼ ê³„ì‚°**
3. ì¢Œí‘œê³„ì˜ **êµ¬ê°„ (Bean) ì •í•˜ê¸°**
4. **Gradient ì— Orientationì´ ì–¼ë§ˆë‚˜ ì¡´ì¬í•˜ëŠ” ì§€ë¥¼ Histogram** ì„ í†µí•´ ë‚˜íƒ€ëƒ„.
5. **Histogram ì˜ Local Maximaë¥¼ ê³„ì‚°.**
6. íŠ¹ì • **ë°©í–¥ìœ¼ë¡œ Patchê°€ Dominant** í•˜ê²Œ ë˜ì–´ìˆë‹¤ëŠ” ê²ƒ í™•ì¸.
7. **Image Warping** ì‹¤í–‰ -> **Rotationì˜ Invariant í•œ ì†ì„±ë“¤ì„ êµ¬í•  ìˆ˜ ìˆë‹¤.**

<br><br>

## View Point
![path](/assets/images/INU/ComputerVision/findingFeatures2_9.png)
> Image 1<br>
> - ìƒëŒ€ì ìœ¼ë¡œ í¼ì³ì ¸ ìˆëŠ” ì´ë¯¸ì§€.<br>
>
> Image 2<br>
> - ë³¼ ìˆ˜ ìˆëŠ” Receptive í•œ ì˜ì—­ì´ ë„“ìŒ.<br>
> - ë„“ì€ ì´ë¯¸ì§€ë¥¼ ì‘ì€ ê³µê°„ì— ë‘ì–´ ì°Œê·¸ëŸ¬ì ¸ ìˆëŠ” ìƒíƒœ.<br><br>
> ì´ëŸ¬í•œ ìƒí™©ì—ì„œ **Viewpoint ê°€ Invariant í•˜ê¸° ìœ„í•´ì„œëŠ” Affine Warping ì˜ ê³¼ì •ì´ í•„ìš”.**

<br><br>

### Affine Warping
> **Warping**<br>
> - **ì¼ë°˜ì ìœ¼ë¡œ ì´ë¯¸ì§€ë¥¼ ë³€í˜• ì‹œí‚¤ëŠ” ê²ƒì„ ëœ»í•¨.**<br>
> - **Affine Transform**<br><br>
> **Interpolation**<br>
> - **Warping ëŒ€ìƒ í”½ì…€ê³¼ ì¸ì ‘í•œ í”½ì…€ë“¤ì˜ ê´€ê³„ë¥¼ ì´ìš©**í•˜ì—¬ Warping.<br><br>
> - Interpolation ì˜ ì„¸ ê°€ì§€ ê¸°ë²•<br>
>     - **Nearest neighbor interpolation**<br>
>     - **Bilinear interpolation**<br>
>     - **Bicubic interpolation**

<br><br>

#### Warping Function
![path](/assets/images/INU/ComputerVision/findingFeatures2_10.png)
> **Warping Funtionì€ Rotation, Rescaling, Translation** ì„ ëª¨ë‘ í¬í•¨í•˜ëŠ” í•¨ìˆ˜.<br>
> - **Rotation : ì´ë¯¸ì§€ íšŒì „**<br>
> - **Rescaling : ìŠ¤ì¼€ì¼ë§ (ë°°ìœ¨)**<br>
> - **Translation : ì´ë¯¸ì§€ ì´ë™**

<br><br>

#### Interpolation
![path](/assets/images/INU/ComputerVision/findingFeatures2_11.png)
> **ì´ë¯¸ì§€ë¥¼ Rescaling, Resizing, Warping í•˜ëŠ” ê²ƒì— ìˆì–´ ë§ì€ ì˜í–¥ì„ ì¤Œ.**

1. **Nearest neighbor**
	- ë§ ê·¸ëŒ€ë¡œ **ê°€ì¥ ê°€ê¹Œìš´ ê°’ì„ ì´ìš©í•´ì„œ ë‹¤ë¥¸ ê°’ì„ "ë³´ê´€ / í• ë‹¹"**.
2. **Bilinear**
	- Linear : ì¢Œí‘œì—ì„œ ì§ì„ ì„ ìƒì„±, ê·¸ **ì§ì„ ì— ëŒ€í•˜ì—¬ ê° ì  ê°„ì˜ yì¢Œí‘œê°€ ì–¼ë§ˆë‚˜ ëŒ€ì‘ë˜ëŠ”ì§€ Linear Function ì„ ì´ìš©í•˜ì—¬ ê³„ì‚°.**
3. **Cubic**
	- **3ì°¨ì‹ì„ ì´ìš©**í•œ Interpolation ê¸°ë²•
	  <br><br>

# Blob Detector
## Harris Detector
![path](/assets/images/INU/ComputerVision/findingFeatures2_12.png)
> **Rotation ì— Invariant í•¨.**<br>
> - ì£¼ì–´ì§„ ì´ë¯¸ì§€ì— ëŒ€í•˜ì—¬ **Rotationì„ ì‹œí‚¤ë”ë¼ë„ iden-value (ì´ë¯¸ì§€ì˜ í˜•íƒœ) ëŠ” ë³€í•˜ì§€ ì•ŠëŠ”ë‹¤.**

<br><br>

### Harris (Corner) Detector
![path](/assets/images/INU/ComputerVision/findingFeatures2_13.png)
> í•˜ì§€ë§Œ **Harris Corner Detector ëŠ” Image Scale ì— ëŒ€í•´ì„œëŠ” Invariant í•˜ì§€ ì•ŠëŠ”ë‹¤.**<br>
> - ì¢Œì¸¡ ì´ë¯¸ì§€ëŠ” í™•ëŒ€ëœ ì½”ë„ˆ ì´ë¯¸ì§€.<br>
>    - **Edge ë¡œì„œ í•´ì„ì´ ë  ìˆ˜ ìˆë‹¤.**<br>
> - ìš°ì¸¡ ì´ë¯¸ì§€ëŠ” ì¶•ì†Œëœ ì½”ë„ˆ ì´ë¯¸ì§€.<br>
>    - **Corner ë¡œì„œ í•´ì„ì´ ë  ìˆ˜ ìˆë‹¤.**<br>
> 		**--> Corner ì— ì ìš©ëœ Harris Detector ëŠ” Scale ì— ëŒ€í•´ì„œ Invariant í•˜ì§€ ì•ŠìŒ.**

<br><br>

## Blob (Binary Large OBjects) Detection
![path](/assets/images/INU/ComputerVision/findingFeatures2_14.png)
> **Image ë‚´ì˜ Pixel ë“¤ì´ ì—°ê²°ë˜ì–´ ìˆê³  ë™ì‹œì— ê·¸ë£¹(ì˜ì—­)ì„ ê°€ì§€ê³  ìˆëŠ” ê²ƒ.**<br>
> - **ë¹„ìŠ·í•œ ì†ì„±ì„ ê³µìœ **í•¨. (ìƒ‰ìƒ, ë°ê¸°...)<br>
>   - í•´ë‹¹ ì†ì„±ì€ **ì¼ì‹œì ì´ì§€ ì•Šê³  ê¾¸ì¤€íˆ ìœ ì§€ë˜ëŠ” ì†ì„±**ì´ì–´ì•¼ í•¨.<br>
> - ì—¬ëŸ¬ í˜•íƒœì˜ ëª¨ì–‘ì´ í¬í•¨ë¨.<br>
> - **ì»´í“¨í„° ë¹„ì „ì—ì„œ ê°€ì¥ ê¸°ë³¸ì ì¸ Concept ë¡œì„œ í™œìš©**ëœë‹¤.

<br><br>

### Blob Detection : Basic Idea
![path](/assets/images/INU/ComputerVision/findingFeatures2_15.png)
> **Image ì— ëŒ€í•´ Blob Filter (Kernel) ì„ Convolution.**<br>
> - response ë¥¼ ì–»ì„ ìˆ˜ ìˆê²Œ ë¨.<br>
>    - **ë°ì€ ë¶€ë¶„ : Maxima**<br>
>    - **ì–´ë‘ìš´ ë¶€ë¶„ : Minima**<br>
> - Response ë¥¼ í†µí•´ Blob ì˜ì—­ì„ ì°¾ì„ ìˆ˜ ìˆëŠ” ë‹¨ì„œë¥¼ ì–»ì„ ìˆ˜ ìˆë‹¤.

<br><br>

### Blob Filter
![path](/assets/images/INU/ComputerVision/findingFeatures2_16.png)
> **Blob Filter ëŠ” ì¼ë°˜ì ìœ¼ë¡œ Gaussian ì„ ë‘ ë²ˆ ë¯¸ë¶„í•œ Laplacian of Gaussian (LoG) ë¥¼ í™œìš©í•œë‹¤.**<br>
> - LoG ëŠ” Gaussian ì˜ ì†ì„±ì„ ë”°ë¥´ê¸° ë•Œë¬¸ì— **ì›í˜•ì„ ë„ê³  ìˆìŒ.**<br>
> - Gaussian ì´ê¸° ë•Œë¬¸ì— **Circularly & Symmetric í•¨.**<br>
>     - **Gaussian í•¨ìˆ˜ê°€ ì¤‘ì‹¬ì„ ê¸°ì¤€ìœ¼ë¡œ ì›í˜• ëŒ€ì¹­ì„ ê°€ì§€ê³  ìˆë‹¤ëŠ” ì˜ë¯¸.**<br>
>         - Gaussian í•¨ìˆ˜ì˜ ê°’ì€ **ì¤‘ì‹¬ì—ì„œ ìµœëŒ€ê°€ ë˜ê³  ì¤‘ì‹¬ì—ì„œ ë©€ì–´ì§ˆìˆ˜ë¡ ê°ì†Œí•˜ëŠ” í˜•íƒœ**ë¡œ ë¶„í¬.<br>
>         - Gaussian í•¨ìˆ˜ëŠ” **íšŒì „ì— ëŒ€í•´ì„œ ëŒ€ì¹­.**<br>
>             - **ì¦‰ ì–´ë–¤ ê°ë„ë¡œ íšŒì „í•˜ë”ë¼ë„ ëª¨ì–‘ì´ ë³€í•˜ì§€ ì•ŠìŒ.**<br>
>             - ì´ëŸ¬í•œ **ì›í˜• ëŒ€ì¹­ì„±ê³¼ íšŒì „ ëŒ€ì¹­ì„±ì€ ì´ë¯¸ì§€ ì²˜ë¦¬ì—ì„œ í•„í„°ë§ ì‘ì—…ì„ ìˆ˜í–‰í•  ë•Œ ìœ ìš©.**<br>
>             - ì˜ìƒì˜ íŠ¹ì • ë°©í–¥ ë˜ëŠ” íšŒì „ì— ë¯¼ê°í•˜ì§€ ì•Šë„ë¡ ë„ì™€ì¤Œ.

<br><br>

### Edge Detection with LoG
![path](/assets/images/INU/ComputerVision/findingFeatures2_17.png)
> Convolution ê²°ê³¼ ê·¸ë˜í”„ì—ì„œ **0ì„ ê±°ì¹˜ëŠ” ìˆœê°„ì˜ ì  ê·¼ë°©ì´ Edge** ë¼ê³  íŒë‹¨ ê°€ëŠ¥.

<br><br>

![path](/assets/images/INU/ComputerVision/findingFeatures2_18.png)
Original Signal ê·¸ë˜í”„ì˜ Edge ë¶€ë¶„ì„ ë‚˜íƒ€ë‚´ëŠ” 0 ê³¼ 1 ì‚¬ì´ ë³€í™˜ êµ¬ê°„ == Edge
- **LoG Filter ë¥¼ ì ìš© í–ˆì„ ë•Œ 0 ì„ ê±°ì¹˜ëŠ” ìˆœê°„ê³¼ ê°™ìŒ.**
- ë‘ Edge ì‚¬ì´ ê°’ì´ ë³€í•˜ì§€ ì•Šê³  ì¼ì •.
	- ë‘ Edge ì‚¬ì´ êµ¬ê°„ì€ Blob ì´ë¼ê³  ë³¼ ìˆ˜ ìˆìŒ.

> **LoG ë¥¼ ì ìš© (Convolution) í–ˆì„ ë•Œ, Maximum & Minimum ì´ ë°œìƒí•˜ëŠ” êµ¬ê°„ì´ Blob ì´ë‹¤.** <br>
> **ì ì ˆí•œ ì‹œê·¸ë§ˆë¥¼ ì°¾ëŠ” ê²ƒì´ Blob ì„ ì°¾ëŠ” ê²ƒì— ìˆì–´ ê°€ì¥ ì¤‘ìš”í•¨.**

<br><br>

### Scale Selection
![path](/assets/images/INU/ComputerVision/findingFeatures2_19.png)
> **Blob ì˜ íŠ¹ì • Scale ì°¾ê¸°.**<br>
> - LoG ë¥¼ ì‚¬ìš©í•´ì„œ (Convolving) **Maximum Response** ë¥¼ ì°¾ì„ ê²ƒ.<br>
> **ë¬¸ì œì **<br>
> - Laplacian ì— ëŒ€í•œ Response ëŠ” Scale ì´ ì»¤ì§ˆìˆ˜ë¡ Response ê°€ ì‘ì•„ì§.<br>
>     - ìœ„ ì‚¬ì§„ê³¼ ê°™ì´ Original signal ì— ëŒ€í•´ì„œ ì‹œê·¸ë§ˆ ê°’ì´ ì»¤ì§ˆìˆ˜ë¡ Laplacian Response (Kernel ì— ëŒ€í•œ Response) ê°€ ì‘ì•„ì§€ëŠ” ê²ƒì„ ë³¼ ìˆ˜ ìˆìŒ.<br>
>     - ì´ëŠ” Maximum Response ë¥¼ ì°¾ê¸° ì–´ë ¤ì›Œì§.

<br><br>

### Scale Normalization
![path](/assets/images/INU/ComputerVision/findingFeatures2_20.png)
> Scale Selection ì˜ ë¬¸ì œì  í•´ê²°ì„ ìœ„í•´ ë‚˜ì˜¨ ê¸°ë²•. <br><br>
> **LoG ì˜ ì‹œê·¸ë§ˆ ê°’ì´ ì»¤ì§ˆìˆ˜ë¡ Response ê°€ ì‘ì•„ì§€ëŠ” ë¬¸ì œ.**<br><br>
> ì´ì— Response ë¥¼ ìœ ì§€í•˜ê¸° ìœ„í•´ Gaussian ì— ì‹œê·¸ë§ˆ(Factor) ë¥¼ ê³±í•´ ì‚¬ìš©.<br><br>
> - **LoG ëŠ” Gaussian ì„ ë‘ ë²ˆ ë¯¸ë¶„í•œ ê²ƒì´ê¸° ë•Œë¬¸ì— ì‹œê·¸ë§ˆì˜ ì œê³±ì„ ê³±í•´ í™œìš©.**

<br><br>

**Effect of scale normalization**
![path](/assets/images/INU/ComputerVision/findingFeatures2_21.png)
> - ìƒë‹¨ ê·¸ë˜í”„ëŠ” Scale normalization ì ìš© ì „.<br>
> - í•˜ë‹¨ ê·¸ë˜í”„ëŠ” Scale normalization ì ìš© í›„.<br>

- **Scale Normalization ì„ í†µí•´ ìš°ë¦¬ëŠ” Blobì— ì í•©í•œ Scale ì˜ í¬ê¸°ë¥¼ ì°¾ì•„ ë‚¼ ìˆ˜ ìˆë‹¤.**

<br><br>
### Scale Selection ë¬¸ì œ í•´ê²°
> ![path](/assets/images/INU/ComputerVision/findingFeatures2_22.png)
> - **ë°˜ì§€ë¦„ì´ rì¸ Blobì— ëŒ€í•˜ì—¬ Laplacian ì´ ê°€ì¥ ì¢‹ì€ Maximum Response ë¥¼ ë‚˜íƒ€ë‚´ëŠ” Scaleì˜ í¬ê¸°ëŠ”?**
> 	- **Sigma = r / âˆš2**

<br><br>

> ![path](/assets/images/INU/ComputerVision/findingFeatures2_23.png)
> - Blob ì˜ Center ì—ì„œ ê°€ì¥ Peak í•œ Laplacian Response ë¥¼ ìƒì„±í•˜ëŠ” Scale ì„ **Characteristic Scale** ì´ë¼ê³  í•œë‹¤.

<br><br>

# SIFT Blob Detector and Descriptor
> **Scale ì— Invariant í•œ Feature Transform.**<br><br>
> **General Idea**
> - **Image ì˜ íŠ¹ì§•**ì„ ì°¾ì•„ë‚´ëŠ” ê²ƒ. <br><br>
> *SIFT Blob Detector ì˜ íŠ¹ì§•**
> - **Translation Invariant**
>    - ëŒ€ë¶€ë¶„ì˜ Feature Extractor ë“¤ì´ ê°€ì§€ê³  ìˆëŠ” ì†ì„±.
> - **Rotation Invariant**
>    - Harris Corner Detector ì™€ ê°™ì€ ì†ì„±.
> - **Scaling Invariant**
>    - Harris Corner Detector ì˜ ë‹¨ì ì„ í•´ê²°.
>      - ì½”ë„ˆ / ì—£ì§€ êµ¬ë¶„ ê°€ëŠ¥.

![path](/assets/images/INU/ComputerVision/findingFeatures2_24.png)
> ìœ„ ì‚¬ì§„ì²˜ëŸ¼ ê° ì´ë¯¸ì§€ì˜ íŠ¹ì§•ì ì¸ Patch ê°€ íšŒì „ì´ ë˜ê±°ë‚˜ Scale ë˜ì–´ Patch ì˜ í¬ê¸°ê°€ ì¶•ì†Œ ë° í™•ì¥ë˜ì–´ë„ ì˜ ì°¾ì•„ë‚´ëŠ” ê²ƒì„ ë³¼ ìˆ˜ ìˆë‹¤.

<br><br>
## SIFT ì˜ ì£¼ìš” ê³„ì‚° ê³¼ì •
1. **Scale-space Extrema Detection**
	- **Scale-space ì—ì„œ ê·¹ê°’ì„ ì°¾ì•„ë‚´ëŠ” ê³¼ì •.**
	- **Laplacian Pyramid** (Difference of Gaussian)
		- ëª¨ë“  Scale ì—ì„œ ê·¹ê°’ë“¤ì„ ì°¾ì•„ëƒ„.
2. **Keypoint Localization & Filtering**
	- **ì´ë¯¸ì§€ë‚´ì—ì„œ íŠ¹ì • ì˜ì—­ - Keypoint candidate, ì¦‰ í›„ë³´êµ°ë“¤ì„ ì°¾ì•„ëƒ„.**
	- ê·¸ ê³¼ì •ì—ì„œ ë¶ˆí•„ìš”í•œ ì˜ì—­ (Keypoint) ë“¤ì„ ì œê±°.
3. **Orientation Assignment**
	- í•´ë‹¹ Keypoint ê°€ ì–´ë–¤ Orientation ì„ ê°€ì§€ê³  ìˆëŠ”ì§€.
		- **í•´ë‹¹ ì´ë¯¸ì§€ë¥¼ ì–´ë–¤ íŠ¹ì§•ìœ¼ë¡œ ë§Œë“¤ê¸° ìœ„í•´ ì–´ë– í•œ Gradient ë°©í–¥ì„ ê°€ì§€ê³  ìˆëŠ”ì§€ ì°¾ì•„ë‚´ëŠ” ê³¼ì •.**
4. **Creation of SIFT Keypoint Descriptor**
	- **ì´ë¯¸ì§€ë¥¼ Matching** ì‹œí‚¤ê¸° ìœ„í•´ì„œëŠ” ì§ì ‘ ë¹„êµê°€ ì•„ë‹Œ, **Vector ë¡œ ë°”ê¾¸ì–´ ë¹„êµë¥¼ ìˆ˜í–‰**í•˜ê²Œ ë¨.
	- í•´ë‹¹ ê³¼ì •ì„ ì§„í–‰í•˜ê¸° ìœ„í•´ **ì£¼ì–´ì§„ ì´ë¯¸ì§€ì—ì„œ íŠ¹ì •í•œ ì†ì„±ë“¤ì„ ì¶”ì¶œí•˜ì—¬ ìˆ˜ì¹˜í™” ì‹œí‚¤ëŠ” ê³¼ì •.**

## Step 1. Scale-space Extrema Detection
![path](/assets/images/INU/ComputerVision/findingFeatures2_25.png)
> ì•ì„œ LoG ì—ì„œ í™•ì¸í–ˆë“¯ì´, **ì´ë¯¸ì§€ ë¸”ë¡ë“¤ì„ ì°¾ê¸° ìœ„í•´ Charateristic Scale** ì„ í™•ì¸í–ˆì—ˆìŒ. <br><br>
> **ì–´ë–»ê²Œ Scale-space ë¥¼ í™•ì¸í•˜ëŠ”ê°€?**
> - **ì›ë³¸ ì´ë¯¸ì§€ì—ì„œ ì ì§„ì ìœ¼ë¡œ Blurr í•œ ì´ë¯¸ì§€ë¥¼ ë§Œë“¤ì–´ ë‚¸ë‹¤.**
>    - ì´ë¯¸ì§€ì— ëŒ€í•˜ì—¬ **Gaussian Filter** ë¥¼ ì ìš©í•˜ì—¬ ìˆ˜í–‰.
> - **ì´ë•Œ L ë¡œì„œ í‘œí˜„ë˜ëŠ” Scale-space ë¥¼ ì •ì˜** í•  ìˆ˜ ìˆë‹¤.
>    - `L(x, y, Ïƒ) = G(x, y, Ïƒ) * I(x, y)`
>      - **L = Image ì— Gaussian ì„ Convolution.**
>      - **Ïƒ = Scale Parameter** (Kernel Size)
>          - Ïƒ ê°€ ì¦ê°€ í• ìˆ˜ë¡, ImageëŠ” ì ì  ë” Blurr í•´ì§.
> - **Difference of Gaussian**
> 	- í•´ë‹¹ Image ì— **Gaussian Kernel ì„ ì ìš©í•œ ê²°ê³¼ ê°„ì˜ ì°¨ì´**

<br><br>

![path](/assets/images/INU/ComputerVision/findingFeatures2_26.png)
> 1. **Scaling ì— ë”°ë¥¸ Blurring ì˜ íš¨ê³¼ ë° ì´ë¯¸ì§€ì˜ ì¶•ì†Œ / í™•ëŒ€ì— ë”°ë¥¸ ë³€í™”**
> 2. **ì¢Œìš° ì¸ì ‘í•œ ì‚¬ì§„ ê°„ì˜ ì°¨ì´ë¥¼ ë‚˜íƒ€ë‚´ëŠ” DoG (Difference of Gaussian)**

<br><br>
### DoG (Difference of Gaussian) vs LoG (Laplacian of Gaussian)
![path](/assets/images/INU/ComputerVision/findingFeatures2_27.png)
>**Laplacian of Gaussian (LoG) ëŠ” ê³„ì‚°í•˜ëŠ” ê²ƒì— ìˆì–´ ì ì§€ ì•Šì€ ì‹œê°„ì´ ì†Œìš”ë¨.**
>- **ëŒ€ì‹  Difference of Gaussian (DoG) ì„ í†µí•´ Laplacian ê³¼ ê·¼ì‚¬í•œ ê°’ì„ ë„ì¶œ** í•´ë‚¼ ìˆ˜ ìˆìŒ. (Scale & Affine Invariant Interest Point Detectors, Mikolajczyk, 2002.)

<br><br>
### Difference of Gaussian (= Laplacian Pyramid)
![path](/assets/images/INU/ComputerVision/findingFeatures2_28.png)
> ì‰½ê²Œ ë§í•´ì„œ Scale ì´ ë¹„ìŠ·í•œ Image ê°„ì˜ ì°¨ì´ë¥¼ ë„ì¶œí•´ë‚´ëŠ” ê³¼ì •.
> - **ë¹„ìŠ·í•œ Scale ì„ ê°€ì§„ Image ê°„ì˜ ì°¨ì´ == DoG == ì´ë¯¸ì§€ì˜ ê·¹ê°’**
> - ìœ„ ì‚¬ì§„ ìš°ì¸¡ì˜ DoG ëŠ” ê²°êµ­ ì´ì „ì— ë³¸ ì•„ë˜ ì‚¬ì§„ê³¼ ê°™ë‹¤.
>    ![path](/assets/images/INU/ComputerVision/findingFeatures2_29.png)

<br><br>
## Step 2. Keypoint Localization & Filtering
![path](/assets/images/INU/ComputerVision/findingFeatures2_30.png)
> **ì´ì „ì— ê³„ì‚°í•œ DoG ì˜ ìœ—ì¸µê³¼ ì•„ë«ì¸µì„ ê³ ë ¤.**
> - **ê°€ìš´ë° ì¸µì— ì¡´ì¬í•˜ëŠ” íŠ¹ì • í”½ì…€ì˜ ì¸ì ‘í•œ Neighbor ì— ëŒ€í•˜ì—¬ ê°’ì„ ê³„ì‚°.**
> 	- **ìœ— ì¸µì— 9ê°œ** Neighbor
> 	- **ìì‹ ì˜ ì¸µì— ìì‹ ì„ ì œì™¸í•œ 8ê°œ** Neighbor
> 	- **ì•„ë«ì¸µì— 9ê°œ** Neighbor
> 		- **ì´ 26 Neighbors ì— ëŒ€í•˜ì—¬ ë¹„êµë¥¼ ìˆ˜í–‰.**
> - ìœ„ ê³¼ì •ì—ì„œ **Local Extrema (Maximum or Minimum) ì¶”ì¶œ** ê°€ëŠ¥.
> 	- ìœ„ ê°’ì„ ì¶”ì¶œ í›„ **SIFT Keypoint ì˜ Candidate** ë¡œ ê°€ì§€ê³  ìˆê²Œ ëœë‹¤.

<br><br>
![path](/assets/images/INU/ComputerVision/findingFeatures2_31.png)
> ìœ„ ê³¼ì •ì—ì„œ ì¶”ì¶œë˜ì–´ ê°€ì§€ê³  ìˆëŠ” Keypoint Candidates ë“¤ì€ ë³´ë¼ìƒ‰ ì ìœ¼ë¡œ ë‚˜íƒ€ë‚œ ìƒíƒœ.
> - **Matching í•˜ê³ ì í•˜ëŠ” Corner ì™€ Edge ë„ ì˜ ì¶”ì¶œí•˜ê³  ìˆì§€ë§Œ, í•˜ëŠ˜ê³¼ ê°™ì€ ì´ë¯¸ì§€ì˜ Pixel ë³€í™”ê°€ ë§ì´ ì—†ëŠ” ë¶€ë¶„ë„ ë§ì´ Detect í•˜ê³  ìˆìŒ**
> - ì´ëŸ¬í•œ ë¶€ë¶„ì„ ì •ì œí•˜ëŠ” ê³¼ì •ì´ í•„ìš”.

![path](/assets/images/INU/ComputerVision/findingFeatures2_32.png)
> ë¹¨ê°„ìƒ‰ ì ì´ ì‹¤ì œë¡œ ìš°ë¦¬ê°€ ì›í•˜ëŠ” Local Extrema (Maximum, Minimum).
> - í•˜ì§€ë§Œ í˜„ì¬ Detect ë˜ê³  ìˆëŠ” ë³´ë¼ìƒ‰ ì ë“¤ì€ íŒŒë€ìƒ‰ ì .
> - ì§„ì§œ ê·¹ê°’ì„ ì°¾ê³  ìˆì§€ ëª»í•˜ëŠ” ë¬¸ì œ.

<br><br>
![path](/assets/images/INU/ComputerVision/findingFeatures2_33.png)
> ì´ ë¬¸ì œì ì˜ í•´ê²°ì„ ìœ„í•´ ìœ„ì™€ ê°™ì€ ê³¼ì •ì„ ê±°ì³ Keypoint Localization ì˜ ì„±ëŠ¥ì„ í–¥ìƒ.
> - **ê¸°ì¡´ì— ì°¾ì€ Keypoints ë“¤ì˜ Contrast ê°€ íŠ¹ì • ìˆ˜ì¹˜ (ì˜ˆ: 0.03) ë³´ë‹¤ ì‘ì€ ê²½ìš° (Weak Extrema), í•´ë‹¹ Keypoint ëŠ” Candidate ì—ì„œ ì œê±°í•¨.**
> - ê·¸ ê²°ê³¼ë¡œ, ì´ì „ì— íŒŒë€ìƒ‰ ì ìœ¼ë¡œ ë‚˜íƒ€ë‚œ ì§„ì§œ ê·¹ê°’ì´ ì•„ë‹Œ Keypoint ë“¤ì€ ì œê±°ë¨.

<br><br>
![path](/assets/images/INU/ComputerVision/findingFeatures2_34.png)
> ì´í›„, ê¸°ì¡´ì— Candidate ë¡œì„œ ì¡´ì¬í•˜ë˜ ê°€ì§œ ê·¹ê°’ Candidates ë“¤ì€ ëª¨ë‘ ì œê±°ê°€ ëœë‹¤.

<br><br>
![path](/assets/images/INU/ComputerVision/findingFeatures2_35.png)
> ì¶”ê°€ì ì¸ í›„ì²˜ë¦¬ ê³¼ì •
> - Corner ê·¼ì²˜ì—ì„œëŠ” Gradient ê°€ ë‘ ê°€ì§€ ì´ìƒì˜ ë°©í–¥ì„ ê°€ì§€ëŠ” ê²½ìš°ê°€ ì¡´ì¬ í•  ìˆ˜ ìˆìŒ.
> - **Corner ë° Edge ë¶€ê·¼ì— ì¡´ì¬í•˜ëŠ” Keypoints ë“¤ì„ ë”ìš± ì„¸ë°€í•˜ê²Œ ì •ì œ ê°€ëŠ¥.**

<br><br>
## Step 3. Orientation Assignment
![path](/assets/images/INU/ComputerVision/findingFeatures2_36.png)
> ì´ì „ Step ê¹Œì§€ ì°¾ì€ Keypoints ë“¤ì˜ Orientation ì„ ì°¾ì•„ì£¼ëŠ” ê³¼ì •ì´ í•„ìš”.
> - ìš°ë¦¬ëŠ” Rotation & Scale ì— ëŒ€í•˜ì—¬ Invariant í•œ keypoints ë“¤ì„ ì°¾ì•„ì•¼ í•¨.
>
> <br><br>
> **ê³¼ì •**
> - **ì¢Œ, ìš°ì¸¡ ì´ë¯¸ì§€ì— ëŒ€í•˜ì—¬ Descriptor ë¥¼ ì¶”ì¶œ.**
> 	- **íŠ¹ì •í•œ Vector ì˜ í˜•íƒœ**ë¡œ ê°’ì´ ë„ì¶œë¨.
> 	- ê·¸ê²ƒì´ **Rotation ê³¼ Scale ì— ëŒ€í•œ ì •ë³´ë¥¼ í¬í•¨í•˜ë„ë¡ íŠ¹ì§•ì„ ì¶”ì¶œ**í•´ì•¼í•¨.
> 		- ì´ë¥¼ ìœ„í•´ **Gradient ì˜ Orientation ê³¼ Magnitude ë¥¼ ê³„ì‚°.**

<br><br>
![path](/assets/images/INU/ComputerVision/findingFeatures2_37.png)
> **Magnitude**
> - ì¼ë°˜ì ìœ¼ë¡œ **ë‘ ê°œì˜ í”½ì…€ì˜ ì°¨ë¥¼ ì´ìš©í•˜ëŠ” ê³¼ì •**ìœ¼ë¡œ ì´ë£¨ì–´ì§.
> 	- (x+1) - (x-1) , (y+1) - (y-1)
> - **x, y ì „ì²´ì˜ Magnitude ê³„ì‚°.**
> 	- **x ë° y ë°©í–¥ì˜ Magnitude ê³„ì‚° í›„ ê·¸ê²ƒë“¤ì˜ âˆšì œê³±ì˜ í•©**

<br><br>
![path](/assets/images/INU/ComputerVision/findingFeatures2_38.png)
> ì´í›„ **ê°ê°ì˜ Orientation ì— ëŒ€í•˜ì—¬ Histogram of Local Gradient (HoG Descriptor)** ë¥¼ êµ¬í•œë‹¤.
> - ì–´ëŠ ë°©í–¥ìœ¼ë¡œë¶€í„° ìœ ë˜í–ˆëŠ”ì§€ë¥¼ ê³„ì‚°í•´ë†“ëŠ”ë‹¤.

<br><br>

## Step 4. Creation of SIFT Keypoint Descriptor
> **í˜„ì¬ê¹Œì§€ ìš°ë¦¬ê°€ ê°€ì§€ê³  ìˆëŠ” ê²ƒ**
> 1. **ì´ë¯¸ì§€ì— ëŒ€í•œ ì¢Œí‘œ**
> 	- x, y
> 2. **Scale ì •ë³´**
> 	- Ïƒ
> 3. **Magnitude**
> 	- m
> 4. **Orientation**
> 	- ğœƒ
> 
> <br><br>
> ìœ„ ì •ë³´ë¥¼ ì´ìš©í•´ì„œ ìš°ë¦¬ëŠ” **ìƒˆë¡œìš´ Local Image Descriptor** ë¥¼ ë§Œë“¤ì–´ëƒ„.
> - í•´ë‹¹ Local Image Descriptor ëŠ” **Illumination ê³¼ Viewpoint ì— ëŒ€í•˜ì—¬ Invariant** í•¨.
>    - Viewpoint
>      - ìµœëŒ€ 50ë„ ì •ë„ì˜ ë³€í™”ì—ë„ ë™ì¼í•œ íŠ¹ì§•ì„ ì˜ íƒì§€.
>    - Illumination
>      - í° ë³€í™”ì—ë„ íŠ¹ì§•ì„ ì˜ íƒì§€í•˜ëŠ” ê²ƒì´ ì•Œë ¤ì ¸ ìˆìŒ.

<br><br>
### SIFT Keypoint Descriptor ë¥¼ ë§Œë“œëŠ” ê³¼ì •
![path](/assets/images/INU/ComputerVision/findingFeatures2_39.png)
1. **Compute a gradient histogram over a 4 X 4 pixel region using 8 gradient directions**
	- 4 X 4 Pixel ì˜ ì˜ì—­ì— ëŒ€í•˜ì—¬ 8ê°€ì§€ë°©í–¥ì— ëŒ€í•œ ì„±ë¶„ë“¤ì„ ê³ ë ¤.
2. **Compute a weighted histogram of 4 X 4 windows**
3. **Gaussian weighting around center** (Ïƒ = 0.5 time that of the scale of a keypoint)
4. **4 X 4 X 8 = 128 dimensional feature vector**
	- ìš°ë¦¬ê°€ ê³ ë ¤í•˜ëŠ” Pixel ì˜ì—­ì˜ í¬ê¸°ì™€ ì „ì²´ ë°©í–¥ì„ ê³ ë ¤í•˜ì—¬ ì´ 128 ì°¨ì›ì˜ íŠ¹ì§•ë“¤ì„ ì¶”ì¶œí•´ë‚´ê²Œ ëœë‹¤.

<br><br>

![path](/assets/images/INU/ComputerVision/findingFeatures2_40.png)



ì§€ì‹ ê³µìœ  ë° ê¸°ë¡ì„ ìœ„í•œ ì»´í“¨í„° ë¹„ì „ ê°œì¸ í•™ìŠµ í¬ìŠ¤íŠ¸ì…ë‹ˆë‹¤.
í”¼ë“œë°±ì€ í•­ìƒ í™˜ì˜í•©ë‹ˆë‹¤!
ê¸´ ê¸€ ì½ì–´ì£¼ì…”ì„œ ê°ì‚¬í•©ë‹ˆë‹¤.
{: .notice--success}
{: style="text-align: center;"}

<br><br>

[ì²˜ìŒìœ¼ë¡œ~](#){: .btn .btn--primary }

### Task Lists

>

- [x] Invariant Descriptors
- [x] Scale
- [x] Rotation
- [x] View Point
- [x] Blob Detector
- [x] Harris Detector
- [x] Blob (Binary Large OBjects) Detection
- [x] Scale Selection
- [x] Scale Normalization
- [x] Scale Selection ë¬¸ì œ í•´ê²°
- [x] SIFT Blob Detector and Descriptor
- [x] SIFT ì˜ ì£¼ìš” ê³„ì‚° ê³¼ì •
- [x] Step 1. Scale-space Extrema Detection
- [x] DoG (Difference of Gaussian) vs LoG (Laplacian of Gaussian)
- [x] Difference of Gaussian (= Laplacian Pyramid)
- [x] Step 2. Keypoint Localization & Filtering
- [x] Step 3. Orientation Assignment
- [x] Step 4. Creation of SIFT Keypoint Descriptor
- [x] SIFT Keypoint Descriptor ë¥¼ ë§Œë“œëŠ” ê³¼ì •
